<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://raw.githack.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-detector.js"></script>
    <script src="https://raw.githack.com/AR-js-org/studio-backend/master/src/modules/marker/tools/gesture-handler.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene
        vr-mode-ui="enabled: false;"
        loading-screen="enabled: false;"
        renderer="logarithmicDepthBuffer: true;"
        arjs="trackingMethod: best; sourceType: webcam; detectionMode: mono_and_matrix; debugUIEnabled: false;"
        embedded
        gesture-detector
    >
        <a-assets>
            <a-asset-item
                id="animated-asset"
                src="assets/asset.glb"
            ></a-asset-item>
        </a-assets>

        <a-entity
            id="bowser-model"
            scale="0 0 0" <!-- Initial scale is set to 0 -->
            animation-mixer="loop: repeat"
            gltf-model="#animated-asset"
            class="clickable"
            gesture-handler
        ></a-entity>

        <a-entity camera
            id="camera-entity"
            cursor="fuse: false; rayOrigin: mouse;"
            raycaster="objects: .ground"
        ></a-entity>

        <!-- Ground Plane -->
        <a-plane
            class="ground"
            position="0 0 0"
            rotation="-90 0 0"
            width="20"
            height="20"
            color="#7BC8A4"
        ></a-plane>

        <script>
            const bowserModel = document.querySelector("#bowser-model");

            document.querySelector("#camera-entity").addEventListener("click", function (event) {
                const intersection = event.detail.intersectedEl;
                if (intersection && intersection.object3D) {
                    const position = intersection.object3D.position;
                    bowserModel.setAttribute("position", position);

                    // Set scale to 1 to make the model visible
                    bowserModel.setAttribute("scale", "1 1 1");
                }
            });

            document.querySelector("#camera-entity").addEventListener("wheel", function (event) {
                // Zoom in/out when using the mouse wheel
                const currentScale = bowserModel.getAttribute("scale");
                const scaleMultiplier = event.deltaY > 0 ? 0.9 : 1.1; // Adjust as needed
                const newScale = {
                    x: currentScale.x * scaleMultiplier,
                    y: currentScale.y * scaleMultiplier,
                    z: currentScale.z * scaleMultiplier,
                };
                bowserModel.setAttribute("scale", newScale);
            });
        </script>
    </a-scene>
</body>
</html>
